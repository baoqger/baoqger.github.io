<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Build Microservices with Service Fabric: A Hands-on Approach | Chris Bao&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="BackgroundIn this article, I want to introduce a distributed systems platform: Service Fabric, that is used to build microservices.  First things first, what is Service Fabric? In the software world,">
<meta property="og:type" content="article">
<meta property="og:title" content="Build Microservices with Service Fabric: A Hands-on Approach">
<meta property="og:url" content="https://baoqger.github.io/2023/03/20/guide-to-service-fabric-architecture/index.html">
<meta property="og:site_name" content="Chris Bao&#39;s Blog">
<meta property="og:description" content="BackgroundIn this article, I want to introduce a distributed systems platform: Service Fabric, that is used to build microservices.  First things first, what is Service Fabric? In the software world,">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://baoqger.github.io/images/health-metrics-ui.png">
<meta property="og:image" content="https://baoqger.github.io/images/reliable-services.png">
<meta property="og:image" content="https://baoqger.github.io/images/actor-model.png">
<meta property="og:image" content="https://baoqger.github.io/images/healthmetrics-architecture.png">
<meta property="og:image" content="https://baoqger.github.io/images/partition-replication.png">
<meta property="og:image" content="https://baoqger.github.io/images/partition-key.png">
<meta property="article:published_time" content="2023-03-20T10:18:32.000Z">
<meta property="article:modified_time" content="2024-05-02T07:40:45.593Z">
<meta property="article:author" content="Chris Bao">
<meta property="article:tag" content="Service Fabric, stateless, stateful, actor model, scalability, reliability,  partition">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://baoqger.github.io/images/health-metrics-ui.png">
  
    <link rel="alternate" href="/atom.xml" title="Chris Bao&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Chris Bao&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/project">Project</a>
        
          <a class="main-nav-link" href="/book-reviews">Book Review</a>
        
          <a class="main-nav-link" href="/solopreneur">Solopreneur</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://baoqger.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-guide-to-service-fabric-architecture" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/03/20/guide-to-service-fabric-architecture/" class="article-date">
  <time datetime="2023-03-20T10:18:32.000Z" itemprop="datePublished">2023-03-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Build Microservices with Service Fabric: A Hands-on Approach
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h3><p>In this article, I want to introduce a distributed systems platform: <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/service-fabric/service-fabric-overview"><code>Service Fabric</code></a>, that is used to build microservices. </p>
<p>First things first, what is <code>Service Fabric</code>? In the software world, <code>Service Fabric</code> is in the scope of the <code>orchestrator</code>. So it is the competitor of <a target="_blank" rel="noopener" href="https://kubernetes.io/"><code>Kubernetes</code></a>, <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/swarm/"><code>Docker Swarm</code></a>, etc. </p>
<p>I know what you’re thinking about, at the time of writing, <code>Kubernetes</code> already won the competition. Why am I still writing about <code>Service Fabric</code>? My motivation to write this post is as follows:</p>
<ul>
<li>Firstly, I once used <code>Service Fabric</code> to build microservices and learned something valuable about it. I want to summarize all my learnings and share them with you here! </li>
<li>Secondly, we can (simply) examine both <code>Service Fabric</code> and <code>Kubernetes</code> to understand why the cloud-native solution is better and what problems it can solve. </li>
<li>Finally, <code>Service Fabric</code> is still widely used in some enterprise applications, in detail, you can refer <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/service-fabric/service-fabric-application-scenarios">here</a>. So the skills you learned about service fabric are valuable. </li>
</ul>
<h3 id="Hands-on-Project"><a href="#Hands-on-Project" class="headerlink" title="Hands-on Project"></a>Hands-on Project</h3><p>To learn the <code>Service Fabric</code> platform, we will examine an open-source project: <a target="_blank" rel="noopener" href="https://github.com/baoqger/service-fabric-dotnet-data-aggregation">HealthMetrics</a>. This project is originally developed by Microsoft itself to demonstrate the power of service fabric and I added some enhancements to it, in detail please refer to this <a target="_blank" rel="noopener" href="https://github.com/baoqger/service-fabric-dotnet-data-aggregation">GitHub repo</a>.</p>
<p>At the business requirement level, this application goes like this: each <code>patient</code> keeps reporting the heart rate data to the <code>doctor</code> via the wearable device(the <code>band</code> in this case). And the <code>doctor</code> aggregates the collected health data and reports to the <code>county</code> service. Each <code>county</code> service instance runs some statistics on doctors’ data and sends the report to the <code>country</code> service. Finally, you can get something as follows: </p>
<img src="/images/health-metrics-ui.png" title="health metrics" width="800px" height="600px">

<p>Before we explore the detailed implementation, you can pause here for a few minutes. How will you design the architecture if this application is assigned to you? How to make it both <code>reliable</code> and <code>scalable</code>?  </p>
<h3 id="Service-Fabric-Programming-Model"><a href="#Service-Fabric-Programming-Model" class="headerlink" title="Service Fabric Programming Model"></a>Service Fabric Programming Model</h3><p><code>Service Fabric</code> provides multiple ways to write and manage your services: </p>
<ul>
<li>Reliable Services: is the most popular choice in the context of service fabric, we’ll examine much more about it later. </li>
<li>Containers: service fabric can also deploy services in containers. But if you choose to use containers, why not directly use <code>Kubernetes</code>? I’ll not cover it in this post. </li>
<li>Guest executables: You can run any type of code or script like Node.js as guest executables in the service fabric. Note that the service fabric platform doesn’t include the runtime for the guest executables, instead, the operating system hosting the service fabric must provide the corresponding runtime for the given language. It provides a flexible way to run legacy applications within microservices. If you have an interest in it, please refer to this <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/service-fabric/service-fabric-guest-executables-introduction">article</a>, I will not examine the details in this post.</li>
</ul>
<p>Next, let’s examine what are <code>Reliable Services</code>.</p>
<h3 id="Reliable-Services"><a href="#Reliable-Services" class="headerlink" title="Reliable Services"></a>Reliable Services</h3><p>As I mentioned above, <code>service fabric</code> is an <code>orchestrator</code> which provides infrastructure-level functionalities like <code>cluster management</code>, <code>service discovery</code>, and <code>scaling</code> as <code>Kubernetes</code> does. But <code>service fabric</code> goes further by also providing a <code>reliable services</code> model to guide the development on the application level, this’s a special point compared to <code>Kubernetes</code>. Simply speaking, the application code can call the <code>service fabric</code> runtime APIs to query the system for building reliable applications. In the following sections, I’ll show you what that means with some code blocks. </p>
<p><code>Reliable Services</code> can be classified into two types as follows: </p>
<ul>
<li>Stateless service: when we mentioned stateless service in the context of service fabric, we are not saying that the service doesn’t have any state to store, but it means that the service doesn’t store the data inside the cluster of service fabric. Indeed, the stateless service can store states in the external database. The naming of stateless is relative to the cluster. </li>
<li>Stateful service: similarly, the stateful service keeps its state locally in the service fabric cluster, which means the data and service are in the same virtual or physical machine. And this is called <code>Reliable Collections</code>. Compared with external data storage, <code>Reliable Collections</code> implies low latency and high performance. In the following section, I will introduce more about <code>Reliable Collections</code>, which is a very interesting topic. Please hold on!</li>
</ul>
<img src="/images/reliable-services.png" title="reliable services" width="600px" height="400px">

<p>Besides stateless and stateful services listed above, there is the third type of service provided by Service Fabric: <code>Actor Service</code>. </p>
<ul>
<li>Actor Service: is a special type of stateful service, which applies the <code>actor model</code> theory. The <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Actor_model"><code>actor model</code></a> is a general computer science theory handling <code>concurrent computation</code>. It is a very big topic worthy of a separate article. I’ll not cover the details in this post, instead, let’s go through this model in the context of service fabric. </li>
</ul>
<p>The <code>actor model</code> is proposed many years ago in 1973 to simplify the process of writing concurrent programs with the following several advantages: </p>
<ul>
<li>Encapsulation: in the actor model, each actor is a self-contained unit that encapsulates its own state and behavior. And each actor runs <code>only one thread</code>, so you don’t have to worry about complex multi-threading programming issues. But how does it support high concurrency? Just allocate <code>more actor instances</code> as the load goes up.   </li>
<li>Message passing: different from the traditional multi-threading programming techniques, actors do not <code>share memories</code>, instead, they communicate with async message-passing communication, which can reduce the complexity of concurrent programs. </li>
<li>Location transparency: as a self-contained computation unit, each actor can be located on different machines, which makes it the perfect solution for building distributed applications as service fabric does. </li>
</ul>
<p>In the future, I will write an article on the actor model to examine more details about it. Next, let’s take a look at the demo app: <a target="_blank" rel="noopener" href="https://github.com/baoqger/service-fabric-dotnet-data-aggregation">HealthMetrics</a> and analyze how it was built based on the programming models we discussed above. </p>
<img src="/images/actor-model.png" title="actor model" width="400px" height="300px">  

<h3 id="Architecture-of-HealthMetrics"><a href="#Architecture-of-HealthMetrics" class="headerlink" title="Architecture of HealthMetrics"></a>Architecture of HealthMetrics</h3><img src="/images/healthmetrics-architecture.png" title="architecture" width="800px" height="600px">

<p>There are several services included in this <code>HealthMetrics</code> demo application. They are: </p>
<ul>
<li>BandCreationService: this <code>stateless</code> service read the input CSV file and creates the individual <code>band actors</code> and <code>doctor actors</code>. For example, as the above snapshot shows, the application creates roughly 300 band actors and doctor actors.  </li>
<li>BandActor: this <code>actor</code> service is the host for the band actors. Each BandActor represents an individual wearable device, which generates heart rate data and then sends it to the designated DoctorActor every 5 seconds. </li>
<li>DoctorActor: the doctor <code>actor</code> service aggregates all of the data it receives from each band actor and generates an overall view for that doctor and then pushes it into the CountyService every 5 seconds.</li>
<li>CountyService: this <code>stateful</code> service aggregates the information provided by the doctor actor further and also pushes the data into the NationalService. </li>
<li>NationalService: this <code>stateful</code> service maintains the total aggerated data for the entire county and is used to serve data requested by WebService. </li>
<li>WebService: this <code>stateless</code> service just hosts a simple web API to query information from NationalService and render the data on the web UI. </li>
</ul>
<p>As you can see, this demo application consists of all three types of services provided by service fabric, which is a perfect case to learn <code>service fabric</code>, right? </p>
<p>In the next sections, let’s examine what kinds of techniques of service fabric are applied to build this highly <code>scalable</code> and <code>available</code> microservices application. </p>
<h3 id="Naming-Perspective"><a href="#Naming-Perspective" class="headerlink" title="Naming Perspective"></a>Naming Perspective</h3><p><code>Naming</code> plays an important role in the <code>distributed system</code>. They are used to share resources, to uniquely identify entities, to refer to locations, and so on. In the <code>distributed system</code>, each name should be resolved to the entity it refers to. To resolve names, it is necessary to implement a <code>naming system</code>.</p>
<p>In <code>Service Fabric</code>, <code>naming</code> is used to identify and locate <code>services</code> and <code>actors</code> within a cluster. And <code>Service Fabric</code> uses a <code>structured naming</code> system, where services and actors are identified using a <code>hierarchical</code> naming scheme. The naming system is based on the concept of a <code>namespace</code>. A namespace is a logical grouping of related <code>applications</code> and <code>services</code>. In the <code>Service Fabric</code> namespace, the first level is the <code>application</code>, which represents a logical grouping of services, and the second level is the <code>service</code>, which represents a specific unit of functionality that is part of the application. And the default namespace is <code>fabric:/</code>, so the service <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Uniform_Resource_Identifier">URI</a> in the <code>Service Fabric</code> cluster is in the following format: </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fabric:/applicationName/ServiceName</span><br></pre></td></tr></table></figure>
<p>And in our <code>HealthMetrics</code> demo app, the URL will be something like <code>fabric:/HealthMetrics/HealthMetrics.BandActor</code> or <code>fabric:/HealthMetrics/HealthMetrics.CountyService</code>(the application name is <code>HealthMetrics</code> and the service name is <code>HealthMetrics.BandActor</code> or <code>HealthMetrics.CountyService</code>). </p>
<p>In this demo app, we build a helper class <code>ServiceUriBuilder</code> to generate URI as follows: </p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Uri <span class="title">ToUri</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> applicationInstance = <span class="keyword">this</span>.ApplicationInstance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (String.IsNullOrEmpty(applicationInstance))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// the ApplicationName property here automatically prepends &quot;fabric:/&quot; for us</span></span><br><span class="line">            applicationInstance = FabricRuntime.GetActivationContext().ApplicationName.Replace(<span class="string">&quot;fabric:/&quot;</span>, String.Empty);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (InvalidOperationException)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// FabricRuntime is not available. </span></span><br><span class="line">            <span class="comment">// This indicates that this is being called from somewhere outside the Service Fabric cluster.</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Uri(<span class="string">&quot;fabric:/&quot;</span> + applicationInstance + <span class="string">&quot;/&quot;</span> + <span class="keyword">this</span>.ServiceInstance);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>For detail, please refer to this source code <a target="_blank" rel="noopener" href="https://github.com/baoqger/service-fabric-dotnet-data-aggregation/blob/master/HealthMetrics.Common/ServiceUriBuilder.cs">file</a>.</p>
<p>Since the behavior of the name resolver is quite similar to the internet domain name resolver, the <code>Service Fabric Name Service</code> can be regarded as an internal <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Domain_Name_System"><code>DNS</code></a> service. This type of internal <code>DNS</code> service is a common requirement for all distributed systems, including <code>Kubernetes</code>. In the modern <code>cloud-native</code> ecosystem, the popular choice is <a target="_blank" rel="noopener" href="https://coredns.io/"><code>CoreDNS</code></a>, which runs inside K8S. In the future, I will write an article about DNS. Please keep watching my blog’s update.</p>
<p>Besides this default <code>DNS</code> solution mentioned above, you can use other <code>service registry</code> and <code>service discovery</code> solutions. For example, in my <a target="_blank" rel="noopener" href="https://organicprogrammer.com/2020/11/16/golang-service-discovery-consul/">previous article</a>, I once examined how to do this based on <a target="_blank" rel="noopener" href="https://www.consul.io/"><code>Consul</code></a>. Imagine your large-scale application consists of hundreds of microservices, with the default DNS solutions you have to hardcode so many names in each service. That’s just where <code>Consul</code> can help. In detail, I’ll not repeat it here, please refer to my previous article!</p>
<p>Now that we understand how the naming system works, let’s examine how to do inter-service communication based on that. </p>
<h3 id="Communication-Perspective"><a href="#Communication-Perspective" class="headerlink" title="Communication Perspective"></a>Communication Perspective</h3><p>Inter-service communication is at the heart of all distributed systems. For nondistributed platforms, communication between processes can be done by <code>sharing memories</code>. But the communication between processes on different machines has always been based on the low-level message passing as offered by the underlying <code>network</code>. There are two widely used models for communications in distributed systems: <code>Remote Procedure Call(RPC)</code> and <code>Message-Oriented Middleware(MOM)</code>. </p>
<ul>
<li><p><code>Remote Procedure Call(RPC)</code>: is ideal for <code>client-server</code> applications and aims at hiding message-passing details from the client. The <code>HTTP</code> protocol is a typical <code>client-server</code> model, so <code>HTTP</code> requests can be thought of as a type of <code>RPC</code>.  In the <code>client-server</code> model, the client and server <code>must be online at the same time</code> to <code>exchange</code> information, so it’s often called <code>synchronous communication</code>.  </p>
</li>
<li><p><code>Message-Oriented Middleware(MOM)</code>: is suitable for distributed applications, where the communication does not follow the strict pattern of a client-server model. In this model, there are three parties involved: the <code>message producer</code>, the <code>message consumer</code>, and the <code>message broker</code>. In this case, when the <code>message producer</code> publishes the message, the <code>message consumer</code> doesn’t have to be online, the <code>message broker</code> will store the message until the consumer becomes available to receive it, so this model is also called <code>asynchronous communication</code>.</p>
</li>
</ul>
<p>The <code>Service Fabric</code> supports <code>RPC</code> out of the box. In our <code>HealthMetrics</code> demo app, you can find the <code>RPC</code> calls and HTTP requests easily. For example, when the <code>BandActor</code> and the <code>DoctorActor</code> are created, the <code>RPC</code> call is used in the <a target="_blank" rel="noopener" href="https://github.com/baoqger/service-fabric-dotnet-data-aggregation/blob/master/HealthMetrics.BandCreationService/Service.cs#L86"><code>BandCreationService</code></a> as follows: </p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">async</span> Task <span class="title">CreateBandActorTask</span>(<span class="params">BandActorGenerator bag, CancellationToken cancellationToken</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// omit some code for simplicity</span></span><br><span class="line">    ActorId bandActorId;</span><br><span class="line">    ActorId doctorActorId;</span><br><span class="line">    bandActorId = <span class="keyword">new</span> ActorId(Guid.NewGuid()); </span><br><span class="line">    doctorActorId = <span class="keyword">new</span> ActorId(bandActorInfo.DoctorId);</span><br><span class="line">    IDoctorActor docActor = ActorProxy.Create&lt;IDoctorActor&gt;(doctorActorId, <span class="keyword">this</span>.DoctorServiceUri);</span><br><span class="line">    <span class="keyword">await</span> docActor.NewAsync(doctorName, randomCountyRecord);</span><br><span class="line">    IBandActor bandActor = ActorProxy.Create&lt;IBandActor&gt;(bandActorId, <span class="keyword">this</span>.ActorServiceUri);</span><br><span class="line">    <span class="keyword">await</span> bandActor.NewAsync(bandActorInfo);</span><br><span class="line">    <span class="comment">// omit some code for simplicity</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>You can see the <code>ActorProxy</code> instance is created as the <code>RPC</code> client, and the <code>NewAsync</code> method of <code>BandActor</code> and <code>DoctorActor</code> service is called. For example, the <a target="_blank" rel="noopener" href="https://github.com/baoqger/service-fabric-dotnet-data-aggregation/blob/master/HealthMetrics.BandActor/BandActor.cs#L78"><code>NewAsync</code></a> method of <code>BandActor</code> goes like this: </p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">NewAsync</span>(<span class="params">BandInfo info</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="keyword">this</span>.StateManager.SetStateAsync&lt;CountyRecord&gt;(<span class="string">&quot;CountyInfo&quot;</span>, info.CountyInfo);</span><br><span class="line">    <span class="keyword">await</span> <span class="keyword">this</span>.StateManager.SetStateAsync&lt;Guid&gt;(<span class="string">&quot;DoctorId&quot;</span>, info.DoctorId);</span><br><span class="line">    <span class="keyword">await</span> <span class="keyword">this</span>.StateManager.SetStateAsync&lt;HealthIndex&gt;(<span class="string">&quot;HealthIndex&quot;</span>, info.HealthIndex);</span><br><span class="line">    <span class="keyword">await</span> <span class="keyword">this</span>.StateManager.SetStateAsync&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;PatientName&quot;</span>, info.PersonName);</span><br><span class="line">    <span class="keyword">await</span> <span class="keyword">this</span>.StateManager.SetStateAsync&lt;List&lt;HeartRateRecord&gt;&gt;(<span class="string">&quot;HeartRateRecords&quot;</span>, <span class="keyword">new</span> List&lt;HeartRateRecord&gt;()); <span class="comment">// initially the heart rate records are empty list</span></span><br><span class="line">    <span class="keyword">await</span> <span class="keyword">this</span>.RegisterReminders();</span><br><span class="line"></span><br><span class="line">    ActorEventSource.Current.ActorMessage(<span class="keyword">this</span>, <span class="string">&quot;Band created. ID: &#123;0&#125;, Name: &#123;1&#125;, Doctor ID: &#123;2&#125;&quot;</span>, <span class="keyword">this</span>.Id, info.PersonName, info.DoctorId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>You can ignore the detailed content of this method for now, I will explain in a later section.</p>
<p>And when the <code>DoctorActor</code> service reports its status, it calls the <code>CountyService</code> endpoint with HTTP requests: </p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">SendHealthReportToCountyAsync</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// omit some code</span></span><br><span class="line">    <span class="keyword">await</span> servicePartitionClient.InvokeWithRetryAsync(</span><br><span class="line">        client =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            Uri serviceAddress = <span class="keyword">new</span> Uri(</span><br><span class="line">                client.BaseAddress,</span><br><span class="line">                <span class="built_in">string</span>.Format(</span><br><span class="line">                    <span class="string">&quot;county/health/&#123;0&#125;/&#123;1&#125;&quot;</span>,</span><br><span class="line">                    partitionKey.Value.ToString(),</span><br><span class="line">                    id));</span><br><span class="line"></span><br><span class="line">            HttpWebRequest request = WebRequest.CreateHttp(serviceAddress);</span><br><span class="line">            request.Method = <span class="string">&quot;POST&quot;</span>;</span><br><span class="line">            request.ContentType = <span class="string">&quot;application/json&quot;</span>;</span><br><span class="line">            request.KeepAlive = <span class="literal">false</span>;</span><br><span class="line">            request.Timeout = (<span class="built_in">int</span>) client.OperationTimeout.TotalMilliseconds;</span><br><span class="line">            request.ReadWriteTimeout = (<span class="built_in">int</span>) client.ReadWriteTimeout.TotalMilliseconds;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">using</span> (Stream requestStream = request.GetRequestStream())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">using</span> (BufferedStream buffer = <span class="keyword">new</span> BufferedStream(requestStream))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">using</span> (StreamWriter writer = <span class="keyword">new</span> StreamWriter(buffer))</span><br><span class="line">                    &#123;</span><br><span class="line">                        JsonSerializer serializer = <span class="keyword">new</span> JsonSerializer();</span><br><span class="line">                        serializer.Serialize(writer, payload);</span><br><span class="line">                        buffer.Flush();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">using</span> (HttpWebResponse response = (HttpWebResponse) request.GetResponse())</span><br><span class="line">                    &#123;</span><br><span class="line">                        ActorEventSource.Current.Message(<span class="string">&quot;Doctor Sent Data to County: &#123;0&#125;&quot;</span>, serviceAddress);</span><br><span class="line">                        <span class="keyword">return</span> Task.FromResult(<span class="literal">true</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">    <span class="comment">// omit some code</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In the demo app, no <code>asynchronous communication</code> is used. But you can easily integrate the <code>message broker</code> middleware with the <code>Service Fabric</code>. This kind of microservice design is called <code>Event-Driven Architecture</code>. In the future, I will write another article about it, please keep watching my blog!</p>
<h3 id="Scalability-Perspective"><a href="#Scalability-Perspective" class="headerlink" title="Scalability Perspective"></a>Scalability Perspective</h3><p><code>Scalability</code> has become one of the most important design goals for developers of distributed systems. A system can be scalable, meaning that we can easily add more users and resources to the system without any noticeable loss of performance. In most cases, scalability problems in distributed systems appear as performance problems caused by the limited capacity of servers and networks. </p>
<p>Simply speaking, there are two types of scaling techniques: <code>scaling up</code> and <code>scaling out</code>: </p>
<ul>
<li>scaling up: is the process by which a machine is equipped with more and often more powerful resources(e.g., by increasing memory, upgrading CPUs, or replacing network modules) so that it can better accommodate performance-demanding applications. However, there are limits to how much you can scale up a single machine, and at some point, it may become more cost-effective to scale out. </li>
<li>scaling out: is all about extending a networked computer system with more computers and subsequently distributing workloads across the extended set of computers. There are basically only three techniques we can apply: <code>asynchronous communication</code>, <code>replication</code> and <code>Partitioning</code>. </li>
</ul>
<p>We already examined asynchronous communication in the last section. Next, let’s take a deep look at the other two: </p>
<ul>
<li><p><code>Replication</code>:  is a technique, which <code>replicates</code> more components or resources, etc., across a distributed system. <code>Replication</code> not only increases <code>availability</code>; but also helps to balance the load between components, leading to <code>better performance</code>. In Service Fabric, no matter whether it is a stateless or stateful service, you can replicate the service across multiple nodes. As the workload of your application increases, Service Fabric will automatically distribute the load. But <code>replication</code> can only boost performance for <code>read</code> requests (which don’t change data); if you need to optimize the performance for <code>write</code> requests (which change data), you need <code>Partitioning</code>. </p>
</li>
<li><p><code>Partitioning</code>:  is an important scaling technique, which involves taking a component or other resource, splitting it into <code>smaller parts</code>, and subsequently spreading those parts across the system. Each partition only contains a subset of the entire dataset. This can help reduce the amount of data that needs to be processed and accessed by each partition,  which can lead to faster processing times and improved performance. In addition to reducing the size of the data set, partitioning can also improve concurrency and reduce contention.</p>
</li>
</ul>
<p>In Service Fabric, each <code>partition</code> consists of a <code>replica set</code> with a single <code>primary</code> replica and multiple active <code>secondary</code> replicas. Service Fabric makes sure to distribute replicas of partitions across nodes so that secondary replicas of a partition do not end up on the same node as the primary replica, which can increase the <code>availability</code>. </p>
<img src="/images/partition-replication.png" title="partition and replicas" width="600px" height="400px"> 

<p>The difference between a <code>primary</code> replica and a <code>secondary</code> replica is that the <code>primary</code> replica can handle both <code>read and write</code> requests, while the <code>secondary</code> replica can only handle <code>read</code> requests. Moreover, by default, the read requests are only handled by the <code>primary</code> replica, if you want to balance the read requests among all the <code>secondary</code> replicas, you need to set <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/service-fabric/service-fabric-reliable-services-lifecycle"><code>ListenOnSecondary</code></a> at the application code level. You can set the number of replicas with <a target="_blank" rel="noopener" href="https://github.com/baoqger/service-fabric-dotnet-data-aggregation/blob/master/HealthMetricsApplication/Scripts/HealthMetricsDeployment.ps1#L155"><code>MinReplicaSetSize</code></a> and <a target="_blank" rel="noopener" href="https://github.com/baoqger/service-fabric-dotnet-data-aggregation/blob/master/HealthMetricsApplication/Scripts/HealthMetricsDeployment.ps1#L158"><code>TargetReplicaSetSize</code></a></p>
<p>And when the client needs to call the service with multiple partitions, the client needs to generate a <code>ServicePartitionKey</code>; and send requests to the service with this partition key. For example, the <code>DoctorActor</code> sends the health report to the county service with multiple partitions as follows: </p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">SendHealthReportToCountyAsync</span>()</span> &#123;</span><br><span class="line">    <span class="comment">// omit some code </span></span><br><span class="line">    ServicePartitionKey partitionKey = <span class="keyword">new</span> ServicePartitionKey(countyRecord.CountyId);</span><br><span class="line">    ServicePartitionClient&lt;HttpCommunicationClient&gt; servicePartitionClient =</span><br><span class="line">    <span class="keyword">new</span> ServicePartitionClient&lt;HttpCommunicationClient&gt;(</span><br><span class="line">        <span class="keyword">this</span>.clientFactory,</span><br><span class="line">        <span class="keyword">this</span>.countyServiceInstanceUri,</span><br><span class="line">        partitionKey);</span><br><span class="line">    <span class="keyword">await</span> servicePartitionClient.InvokeWithRetryAsync();</span><br><span class="line">    <span class="comment">// omit some code</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>You can see the partition key is generated based on the county id field. Service Fabric provides several different <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/service-fabric/service-fabric-concepts-partitioning">partition schemas</a>. In this case, <code>ranged partitioning</code> is used, where the partition key is an <code>integer</code>. </p>
<p>The county service specifies an integer range by a <a target="_blank" rel="noopener" href="https://github.com/baoqger/service-fabric-dotnet-data-aggregation/blob/master/HealthMetricsApplication/Scripts/HealthMetricsDeployment.ps1#L34"><code>Low Key</code></a> ( set to 0) and <a target="_blank" rel="noopener" href="https://github.com/baoqger/service-fabric-dotnet-data-aggregation/blob/master/HealthMetricsApplication/Scripts/HealthMetricsDeployment.ps1#L35"><code>High Key</code></a> (set to 57000). It also defines the number of partitions as <a target="_blank" rel="noopener" href="https://github.com/baoqger/service-fabric-dotnet-data-aggregation/blob/master/HealthMetricsApplication/Scripts/HealthMetricsDeployment.ps1#L61"><code>PartitionCount</code></a> (set to 3). All the integer keys are evenly distributed among the partitions. So the partitions of the county service go as follows: </p>
<img src="/images/partition-key.png" title="partition key" width="400px" height="300px"> 

<p>As I mentioned above, the county id is unique, we could then generate a hash code based on the id field, then modulus the key range, to finally get the partition key. Service Fabric runtime will direct the requests to the target node based on that partition key. </p>
<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p>In this post, we quickly examined some interesting topics about Service Fabric. I have to admit that Service Fabric is a big project, what I examined here only covers a small portion of the entire system. Feel free to explore more!</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://baoqger.github.io/2023/03/20/guide-to-service-fabric-architecture/" data-id="clvv2765g003u4wmmgpwx57c7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Service-Fabric-stateless-stateful-actor-model-scalability-reliability-partition/" rel="tag">Service Fabric, stateless, stateful, actor model, scalability, reliability,  partition</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2023/04/09/understand-more-aws-service-by-negative-cases/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Scalability Lessons Learned from Amazon Return to The Monolith
        
      </div>
    </a>
  
  
    <a href="/2023/02/13/note-on-red-black-tree/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Understand Red Black Tree: part one - background</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algorithm-Data-structure-Tree-Red-Black-Tree/" rel="tag">Algorithm, Data structure, Tree, Red Black Tree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BPF-JIT-virtual-machine/" rel="tag">BPF, JIT, virtual machine</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Best-practice/" rel="tag">Best practice,</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Binary-Search-Tree-delete-balanced-performance/" rel="tag">Binary Search Tree, delete, balanced, performance</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fabio-Golang-Source-code/" rel="tag">Fabio, Golang, Source code</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Golang-bufio-bytes-buffer/" rel="tag">Golang, bufio, bytes, buffer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Golang-package-workspace-vendor/" rel="tag">Golang, package, workspace, vendor</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP-protocol-Golang-TCP-socket/" rel="tag">HTTP protocol, Golang, TCP, socket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP-system-call-Linux-Golang/" rel="tag">HTTP, system call, Linux, Golang</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP-1-1-concurrent/" rel="tag">HTTP/1.1, concurrent</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP-1-1-persistent-connection-keep-alive-TCP-netstat-tcpdump-Golang-connection-pool/" rel="tag">HTTP/1.1, persistent connection, keep-alive, TCP, netstat, tcpdump, Golang, connection pool</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTPS-TLS-handshake-SSL-TLS/" rel="tag">HTTPS, TLS handshake, SSL/TLS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux-Foundation-Scholarship-LIFT/" rel="tag">Linux Foundation, Scholarship, LIFT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux-module-Netfilter-firewall/" rel="tag">Linux module, Netfilter, firewall</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux-memory-layout-heap-gdb/" rel="tag">Linux, memory layout, heap, gdb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux-memory-layout-heap-stack/" rel="tag">Linux, memory layout, heap, stack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux-system-programming-Windows-Subsystem-for-Linux/" rel="tag">Linux, system programming, Windows Subsystem for Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Scalability-AWS/" rel="tag">Scalability, AWS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Service-Fabric-stateless-stateful-actor-model-scalability-reliability-partition/" rel="tag">Service Fabric, stateless, stateful, actor model, scalability, reliability,  partition</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP-IP/" rel="tag">TCP, IP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm-external-disk/" rel="tag">algorithm, external, disk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/apt-Ubuntu-Linux-package-management/" rel="tag">apt, Ubuntu, Linux, package management</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/certificate-digital-signature-hashing/" rel="tag">certificate, digital signature, hashing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/digital-signature-hash-function/" rel="tag">digital signature, hash function</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker-c-linux/" rel="tag">docker, c++, linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dotnet-GC-memory-leak-WinDbg/" rel="tag">dotnet, GC, memory leak, WinDbg</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/golang-concurrent-shared-memory-message-pass/" rel="tag">golang, concurrent, shared memory, message pass</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/memory-management-stack/" rel="tag">memory management, stack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/microservice-Load-balancing-Consul-Fabio-Golang-Cloud-Native-Docker/" rel="tag">microservice, Load balancing, Consul, Fabio Golang, Cloud-Native, Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/microservice-service-registration-service-discovery-Consul-Golang-Cloud-Native-Docker/" rel="tag">microservice, service registration, service discovery, Consul, Golang, Cloud-Native, Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/network-packet-capture-libpcap-analyze-and-track-network-traffics-detect-network-security-attacks-Linux-system-programming/" rel="tag">network packet capture, libpcap, analyze and track network traffics, detect network security attacks, Linux system programming</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/operating-system-xv6-Unix/" rel="tag">operating system, xv6, Unix</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/packet-sniffer-socket-PF-PACKET/" rel="tag">packet sniffer, socket, PF_PACKET</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/priority-queue-data-structure-algorithm-time-complexity-Big-O-notation/" rel="tag">priority queue, data structure, algorithm, time complexity, Big O notation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/programming-c-array-pointer/" rel="tag">programming c, array, pointer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/public-key-man-in-the-middle-certificate/" rel="tag">public key, man-in-the-middle, certificate</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Algorithm-Data-structure-Tree-Red-Black-Tree/" style="font-size: 10px;">Algorithm, Data structure, Tree, Red Black Tree</a> <a href="/tags/BPF-JIT-virtual-machine/" style="font-size: 10px;">BPF, JIT, virtual machine</a> <a href="/tags/Best-practice/" style="font-size: 10px;">Best practice,</a> <a href="/tags/Binary-Search-Tree-delete-balanced-performance/" style="font-size: 10px;">Binary Search Tree, delete, balanced, performance</a> <a href="/tags/Fabio-Golang-Source-code/" style="font-size: 10px;">Fabio, Golang, Source code</a> <a href="/tags/Golang-bufio-bytes-buffer/" style="font-size: 10px;">Golang, bufio, bytes, buffer</a> <a href="/tags/Golang-package-workspace-vendor/" style="font-size: 10px;">Golang, package, workspace, vendor</a> <a href="/tags/HTTP-protocol-Golang-TCP-socket/" style="font-size: 10px;">HTTP protocol, Golang, TCP, socket</a> <a href="/tags/HTTP-system-call-Linux-Golang/" style="font-size: 10px;">HTTP, system call, Linux, Golang</a> <a href="/tags/HTTP-1-1-concurrent/" style="font-size: 10px;">HTTP/1.1, concurrent</a> <a href="/tags/HTTP-1-1-persistent-connection-keep-alive-TCP-netstat-tcpdump-Golang-connection-pool/" style="font-size: 10px;">HTTP/1.1, persistent connection, keep-alive, TCP, netstat, tcpdump, Golang, connection pool</a> <a href="/tags/HTTPS-TLS-handshake-SSL-TLS/" style="font-size: 10px;">HTTPS, TLS handshake, SSL/TLS</a> <a href="/tags/Linux-Foundation-Scholarship-LIFT/" style="font-size: 10px;">Linux Foundation, Scholarship, LIFT</a> <a href="/tags/Linux-module-Netfilter-firewall/" style="font-size: 20px;">Linux module, Netfilter, firewall</a> <a href="/tags/Linux-memory-layout-heap-gdb/" style="font-size: 15px;">Linux, memory layout, heap, gdb</a> <a href="/tags/Linux-memory-layout-heap-stack/" style="font-size: 10px;">Linux, memory layout, heap, stack</a> <a href="/tags/Linux-system-programming-Windows-Subsystem-for-Linux/" style="font-size: 10px;">Linux, system programming, Windows Subsystem for Linux</a> <a href="/tags/Scalability-AWS/" style="font-size: 10px;">Scalability, AWS</a> <a href="/tags/Service-Fabric-stateless-stateful-actor-model-scalability-reliability-partition/" style="font-size: 10px;">Service Fabric, stateless, stateful, actor model, scalability, reliability,  partition</a> <a href="/tags/TCP-IP/" style="font-size: 10px;">TCP, IP</a> <a href="/tags/algorithm-external-disk/" style="font-size: 15px;">algorithm, external, disk</a> <a href="/tags/apt-Ubuntu-Linux-package-management/" style="font-size: 10px;">apt, Ubuntu, Linux, package management</a> <a href="/tags/certificate-digital-signature-hashing/" style="font-size: 10px;">certificate, digital signature, hashing</a> <a href="/tags/digital-signature-hash-function/" style="font-size: 15px;">digital signature, hash function</a> <a href="/tags/docker-c-linux/" style="font-size: 10px;">docker, c++, linux</a> <a href="/tags/dotnet-GC-memory-leak-WinDbg/" style="font-size: 10px;">dotnet, GC, memory leak, WinDbg</a> <a href="/tags/golang-concurrent-shared-memory-message-pass/" style="font-size: 10px;">golang, concurrent, shared memory, message pass</a> <a href="/tags/memory-management-stack/" style="font-size: 10px;">memory management, stack</a> <a href="/tags/microservice-Load-balancing-Consul-Fabio-Golang-Cloud-Native-Docker/" style="font-size: 10px;">microservice, Load balancing, Consul, Fabio Golang, Cloud-Native, Docker</a> <a href="/tags/microservice-service-registration-service-discovery-Consul-Golang-Cloud-Native-Docker/" style="font-size: 10px;">microservice, service registration, service discovery, Consul, Golang, Cloud-Native, Docker</a> <a href="/tags/network-packet-capture-libpcap-analyze-and-track-network-traffics-detect-network-security-attacks-Linux-system-programming/" style="font-size: 10px;">network packet capture, libpcap, analyze and track network traffics, detect network security attacks, Linux system programming</a> <a href="/tags/operating-system-xv6-Unix/" style="font-size: 10px;">operating system, xv6, Unix</a> <a href="/tags/packet-sniffer-socket-PF-PACKET/" style="font-size: 10px;">packet sniffer, socket, PF_PACKET</a> <a href="/tags/priority-queue-data-structure-algorithm-time-complexity-Big-O-notation/" style="font-size: 10px;">priority queue, data structure, algorithm, time complexity, Big O notation</a> <a href="/tags/programming-c-array-pointer/" style="font-size: 10px;">programming c, array, pointer</a> <a href="/tags/public-key-man-in-the-middle-certificate/" style="font-size: 10px;">public key, man-in-the-middle, certificate</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">May 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/06/">June 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">November 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/05/01/dotnet-gc-memory-leak-windbg/">Diagnose Memory Leaks in .NET Applications with WinDbg: A Hands-on Approach</a>
          </li>
        
          <li>
            <a href="/2023/06/09/lift-scholarship-program/">Linux Foundation Scholarship</a>
          </li>
        
          <li>
            <a href="/2023/04/09/understand-more-aws-service-by-negative-cases/">Scalability Lessons Learned from Amazon Return to The Monolith</a>
          </li>
        
          <li>
            <a href="/2023/03/20/guide-to-service-fabric-architecture/">Build Microservices with Service Fabric: A Hands-on Approach</a>
          </li>
        
          <li>
            <a href="/2023/02/13/note-on-red-black-tree/">Understand Red Black Tree: part one - background</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2024 Chris Bao<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/project" class="mobile-nav-link">Project</a>
  
    <a href="/book-reviews" class="mobile-nav-link">Book Review</a>
  
    <a href="/solopreneur" class="mobile-nav-link">Solopreneur</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>